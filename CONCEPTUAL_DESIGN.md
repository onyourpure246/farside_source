# CASDU Far-Side API - Conceptual Design & Analysis

## 1. Project Overview (‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ)
**Project Name**: `casdu-farside`

**‡∏à‡∏∏‡∏î‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡∏´‡∏•‡∏±‡∏Å (Purpose)**:
‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠ **Backend API Server** ‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏Å‡∏•‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏∞‡∏ö‡∏ö CASDU (Computer Aided Structural Design Unit?) ‡πÇ‡∏î‡∏¢‡∏ñ‡∏π‡∏Å‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏°‡∏≤‡πÉ‡∏´‡πâ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÅ‡∏ö‡∏ö **Standalone Server** ‡∏ö‡∏ô Node.js ‡∏ã‡∏∂‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£ Port (‡∏¢‡πâ‡∏≤‡∏¢) ‡∏°‡∏≤‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏î‡∏¥‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏Ñ‡∏¢‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ö‡∏ô Cloudflare Workers (`casdu-backops`)

**‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç**:
- ‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ API ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Projects, Tasks, Participants ‡πÅ‡∏•‡∏∞‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÑ‡∏ü‡∏•‡πå (Download System)
- ‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡∏Å‡∏•‡∏≤‡∏á‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö Database (MySQL) ‡πÅ‡∏•‡∏∞ File Storage
- ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏Ç‡∏¢‡∏≤‡∏¢‡∏ï‡∏±‡∏ß‡πÅ‡∏•‡∏∞‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡∏ö‡∏ô Server ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£ (On-premise/VPS) ‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢

## 2. Technical Stack & Techniques (‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡πÅ‡∏•‡∏∞‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ)

### Core Framework & Runtime
- **Hono Framework**: ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÉ‡∏ä‡πâ Hono ‡∏ã‡∏∂‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô Web Framework ‡∏ó‡∏µ‡πà‡πÄ‡∏ô‡πâ‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß (Fast), ‡πÄ‡∏•‡πá‡∏Å (Lightweight) ‡πÅ‡∏•‡∏∞‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏î‡πâ‡∏ß‡∏¢ Web Standards API ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÇ‡∏Ñ‡πâ‡∏î‡∏™‡∏∞‡∏≠‡∏≤‡∏î‡πÅ‡∏•‡∏∞‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡∏™‡∏π‡∏á
- **Node.js (via @hono/node-server)**: ‡∏£‡∏±‡∏ô‡∏ö‡∏ô Node.js environment ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ adapter ‡∏Ç‡∏≠‡∏á Hono ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÑ‡∏î‡πâ performance ‡∏ó‡∏µ‡πà‡∏î‡∏µ‡πÅ‡∏•‡∏∞‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ç‡∏≠‡∏á Server ‡πÑ‡∏î‡πâ‡πÄ‡∏ï‡πá‡∏°‡∏ó‡∏µ‡πà (‡πÄ‡∏ä‡πà‡∏ô File System)
- **TypeScript**: ‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏î‡πâ‡∏ß‡∏¢ TypeScript ‡∏ó‡∏±‡πâ‡∏á‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡∏á Type (Type Safety) ‡πÅ‡∏•‡∏∞‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏Ç‡∏ì‡∏∞‡∏û‡∏±‡∏í‡∏ô‡∏≤

### Database & Storage
- **MySQL (`mysql2`)**: ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å Cloudflare D1 ‡∏°‡∏≤‡πÉ‡∏ä‡πâ MySQL ‡∏ã‡∏∂‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô Relational Database ‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö Transaction ‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ã‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô‡πÑ‡∏î‡πâ‡∏î‡∏µ‡∏Å‡∏ß‡πà‡∏≤
- **Local File System**: ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ü‡∏•‡πå‡∏à‡∏≤‡∏Å Cloudflare R2 ‡∏°‡∏≤‡πÉ‡∏ä‡πâ‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ü‡∏•‡πå‡∏•‡∏á Disk ‡∏Ç‡∏≠‡∏á Server ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á (`fs` module) ‡∏ú‡πà‡∏≤‡∏ô Service Wrapper ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏á‡πà‡∏≤‡∏¢‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£

### Architecture & Design Patterns (‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö)
- **Service-Repository Pattern**: ‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÅ‡∏¢‡∏Å‡∏™‡πà‡∏ß‡∏ô‡∏£‡∏±‡∏ö Request (`routes/`) ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏™‡πà‡∏ß‡∏ô‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏ó‡∏≤‡∏á‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à (`services/`) ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô
    - `src/routes/*`: ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ HTTP Request/Response
    - `src/services/*`: ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Business Logic ‡πÅ‡∏•‡∏∞ Database connection
- **Modular Design**: ‡πÅ‡∏¢‡∏Å‡πÇ‡∏°‡∏î‡∏π‡∏•‡∏ï‡∏≤‡∏°‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô:
    - `Commons`: ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô (Participants, Tags)
    - `Planner`: ‡∏£‡∏∞‡∏ö‡∏ö‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏á‡∏≤‡∏ô (Projects, Tasks)
    - `Download (DL)`: ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÑ‡∏ü‡∏•‡πå
- **Dual Authentication Strategy**: ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô 2 ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏î‡∏µ‡∏¢‡∏ß:
    1. **System-to-System**: ‡πÉ‡∏ä‡πâ Bearer Token (API Secret) ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á Server
    2. **User-to-System**: ‡πÉ‡∏ä‡πâ JWT (JSON Web Token) ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ

## 3. Frontend Integration Context (‡∏ö‡∏£‡∏¥‡∏ö‡∏ó‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ö Frontend)
‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå `DEVELOPMENT_MANUAL.md` ‡πÅ‡∏•‡∏∞ Source Code ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° ‡∏û‡∏ö‡∏ß‡πà‡∏≤ Backend ‡∏ô‡∏µ‡πâ‡∏ñ‡∏π‡∏Å‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÇ‡∏î‡∏¢ Frontend Application ‡∏ä‡∏∑‡πà‡∏≠ **"Resource Center"**:

- **Frontend Client**: Web Application ‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏î‡πâ‡∏ß‡∏¢ **Next.js 15 (App Router)**
- **Role of Backend**: ‡∏ó‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô "External Resource Backend" ‡∏´‡∏£‡∏∑‡∏≠ Master Data Source
- **Integration Points**:
    - **Authentication**: Frontend ‡πÉ‡∏ä‡πâ Auth.js (NextAuth) ‡πÇ‡∏î‡∏¢‡∏°‡∏µ‡∏Å‡∏≤‡∏£ Verify ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏†‡∏≤‡∏¢‡πÉ‡∏ô ‡πÅ‡∏•‡∏∞‡∏≠‡∏≤‡∏à‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏ï‡πà‡∏≠ Session context ‡∏°‡∏≤‡∏¢‡∏±‡∏á Backend
    - **Data Models**: Backend ‡∏ï‡πâ‡∏≠‡∏á‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏° Structure ‡∏ó‡∏µ‡πà Frontend ‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á ‡πÇ‡∏î‡∏¢‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÉ‡∏ô‡∏™‡πà‡∏ß‡∏ô **Download System** ‡πÄ‡∏ä‡πà‡∏ô field `mui_colour` ‡πÅ‡∏•‡∏∞ `mui_icon` ‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á Folders (‡∏ã‡∏∂‡πà‡∏á‡∏û‡∏ö‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á‡πÉ‡∏ô `types.ts`)
    - **File Operations**: Frontend ‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô Gateway ‡πÇ‡∏î‡∏¢‡∏£‡∏±‡∏ö‡∏£‡∏π‡πâ‡πÄ‡∏û‡∏µ‡∏¢‡∏á Metadata ‡πÅ‡∏ï‡πà‡∏Å‡∏£‡∏∞‡∏ö‡∏ß‡∏ô‡∏Å‡∏≤‡∏£ Download/Upload ‡πÑ‡∏ü‡∏•‡πå‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏∞‡∏ß‡∏¥‡πà‡∏á‡∏°‡∏≤‡∏ó‡∏µ‡πà Backend ‡∏ô‡∏µ‡πâ

## 4. Conceptual Design Diagram (‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏ä‡∏¥‡∏á‡πÅ‡∏ô‡∏ß‡∏Ñ‡∏¥‡∏î)

```mermaid
graph TD
    User[User / Employee] -->|Access| Frontend[Frontend: Resource Center \n(Next.js 15)]
    
    subgraph "Frontend Layer"
        Frontend -->|Auth via OIDC| ThaID[ThaID Service]
        Frontend -->|Verify Employee| InternalAPI[Internal HR API]
    end
    
    Frontend -->|API Requests \n(Bearer Token)| API[Backend: CASDU Far-Side \n(Hono + Node.js)]
    
    subgraph "Backend Boundary"
        API --> Auth[Auth Middleware]
        
        Router{Router}
        Auth -->|Valid| Router
        
        Router -->|/dl| Download[Download Service]
        Router -->|/planner| Planner[Planner Service]
        Router -->|/commons| Commons[Commons Service]
        
        Download --> DB[(MySQL Database)]
        Download --> FS[File System Server]
    end
```

## 5. Codebase Structure & File Responsibilities (‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå)

‡∏™‡πà‡∏ß‡∏ô‡∏ô‡∏µ‡πâ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏•‡∏∞‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÉ‡∏ô‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î

### üìÅ Root Directory
- **`src/index.ts`**: **‡∏à‡∏∏‡∏î‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏Ç‡∏≠‡∏á‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏° (Main Entry Point)**
  - ‡∏≠‡πà‡∏≤‡∏ô‡∏Ñ‡πà‡∏≤ Environment Variables (`.env`)
  - ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö Database ‡πÅ‡∏•‡∏∞‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Folder ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ü‡∏•‡πå
  - ‡∏™‡∏£‡πâ‡∏≤‡∏á Hono App Instance ‡πÅ‡∏•‡∏∞‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏° Middleware ‡∏´‡∏•‡∏±‡∏Å (CORS)
  - ‡∏Å‡∏≥‡∏´‡∏ô‡∏î Routes ‡∏´‡∏•‡∏±‡∏Å (`/api/fy2569/*`) ‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡πÇ‡∏°‡∏î‡∏π‡∏•‡∏¢‡πà‡∏≠‡∏¢ (Commons, Planner, Download)
  - ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô Server ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ `@hono/node-server`

### üìÅ src/middleware/ (‡∏ï‡∏±‡∏ß‡∏Å‡∏•‡∏≤‡∏á‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Request)
- **`auth.middleware.ts`**: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö JWT Token (Basic setup)
- **`cors.middleware.ts`**: ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Cross-Origin Resource Sharing (CORS) ‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡πÉ‡∏´‡πâ Frontend (Next.js) ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å API ‡πÑ‡∏î‡πâ
- **`dual-auth.middleware.ts`**: **‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå** ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö 2 ‡πÇ‡∏´‡∏°‡∏î:
  1. `Bearer <AUTH_SECRET>`: ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Service-to-Service (‡∏à‡∏≤‡∏Å Frontend Server)
  2. `Bearer <JWT_TOKEN>`: ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö User ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏•‡πá‡∏≠‡∏Ñ‡∏≠‡∏¥‡∏ô‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á)

### üìÅ src/routes/ (‡∏ï‡∏±‡∏ß‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ HTTP Request - Controllers)
‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô (Modular Routes) ‡πÇ‡∏î‡∏¢‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÑ‡∏ü‡∏•‡πå‡∏à‡∏∞‡∏£‡∏±‡∏ö Request, ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å Service, ‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á Response ‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô JSON

#### Download Module (‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏´‡∏•‡∏±‡∏Å‡πÇ‡∏î‡∏¢ Frontend Resource Center)
- **`download.routes.ts`**: ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ API ‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏•‡∏∞‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå (`/dl`)
  - `GET /folder/:id`: ‡∏î‡∏∂‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå
  - `POST /file`: ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏´‡∏°‡πà (‡∏£‡∏±‡∏ö Multipart Form Data)
  - `GET /file/:id?dl=true`: ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå‡∏à‡∏£‡∏¥‡∏á (Stream file ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ)

#### Commons Module (‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô)
- **`commons.routes.ts`**: Router ‡∏´‡∏•‡∏±‡∏Å‡∏ó‡∏µ‡πà‡∏£‡∏ß‡∏° route ‡∏¢‡πà‡∏≠‡∏¢‡∏Ç‡∏≠‡∏á Commons
- **`auth.routes.ts`**: API ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö User Login/Register ‡πÅ‡∏•‡∏∞ Profile (‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÉ‡∏ä‡πâ‡πÉ‡∏ô Resource Center ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÑ‡∏õ‡πÉ‡∏ä‡πâ ThaID ‡∏ó‡∏µ‡πà Frontend ‡πÅ‡∏ó‡∏ô)
- **`participant.routes.ts`**: ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô/‡∏ú‡∏π‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏° (`participants`)
- **`tag.routes.ts`**: ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏õ‡πâ‡∏≤‡∏¢‡∏Å‡∏≥‡∏Å‡∏±‡∏ö (Tags)

#### Planner Module (‡∏£‡∏∞‡∏ö‡∏ö‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏á‡∏≤‡∏ô - ‡∏Ñ‡∏≤‡∏î‡∏ß‡πà‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÉ‡∏ô Resource Center)
- **`planner.routes.ts`**: Router ‡∏´‡∏•‡∏±‡∏Å‡∏ó‡∏µ‡πà‡∏£‡∏ß‡∏° route ‡∏¢‡πà‡∏≠‡∏¢‡∏Ç‡∏≠‡∏á Planner
- **`project.routes.ts`**: CRUD ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Projects
- **`task.routes.ts`**: CRUD ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Tasks
- **`task-participant.routes.ts`**: ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ô‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö‡∏á‡∏≤‡∏ô
- **`gantt.routes.ts`**: API ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ß‡∏≤‡∏î Gantt Chart

### üìÅ src/services/ (Business Logic & Data Access)
‡πÄ‡∏õ‡πá‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Å‡∏±‡∏ö Database ‡πÅ‡∏•‡∏∞ File System ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á (Service Layer)

- **`database.service.ts`**: ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ MySQL Connection Pool ‡πÅ‡∏•‡∏∞‡∏°‡∏µ Wrapper function (`query`, `execute`) ‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô SQL ‡∏á‡πà‡∏≤‡∏¢‡∏Ç‡∏∂‡πâ‡∏ô
- **`file-storage.service.ts`**: ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÑ‡∏ü‡∏•‡πå‡∏ö‡∏ô Disk (`fs`) ‡πÄ‡∏ä‡πà‡∏ô saveFile, readFile, deleteFile (‡∏ó‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÅ‡∏ó‡∏ô Cloudflare R2 ‡πÄ‡∏î‡∏¥‡∏°)
- **`download.service.ts`**: Logic ‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏ü‡∏•‡πå
  - ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Table `dl_folders` ‡πÅ‡∏•‡∏∞ `dl_files`
  - ‡πÄ‡∏ï‡∏¥‡∏°‡∏Ñ‡πà‡∏≤ Default (`mui_icon`, `mui_colour`) ‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏ó‡∏µ‡πà Frontend ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
  - ‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ô‡∏á‡∏≤‡∏ô‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á Database (Metadata) ‡πÅ‡∏•‡∏∞ File Storage (Physical File)
- **`auth.service.ts`**: Logic ‡∏Å‡∏≤‡∏£ Login, Hashing Password (bcrypt), ‡πÅ‡∏•‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á JWT Token
- **`participant.service.ts`**: CRUD ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏≤‡∏£‡∏≤‡∏á `common_participants`
- **`project.service.ts`**, **`task.service.ts`**, **`tag.service.ts`**: CRUD Logic ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Modules ‡∏ô‡∏±‡πâ‡∏ô‡πÜ

### üìÅ Other Files
- **`src/types.ts`**: ‡∏£‡∏ß‡∏° TypeScript Interfaces ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (Database Schema Types, API Request/Response Types) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏à‡∏ß‡πà‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á‡πÑ‡∏õ‡∏°‡∏≤‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á

## 6. Key Considerations (‡∏Ç‡πâ‡∏≠‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç)
- **Scalability**: ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏°‡∏≤‡πÉ‡∏ä‡πâ Node.js/MySQL ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ Scale ‡πÅ‡∏ö‡∏ö Vertical (‡πÄ‡∏û‡∏¥‡πà‡∏° resources ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á) ‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢
- **Maintainability**: ‡πÇ‡∏Ñ‡πâ‡∏î‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏° clean ‡∏™‡∏π‡∏á‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ Hono ‡πÅ‡∏•‡∏∞ TypeScript
- **Migration Context**: ‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠ "‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á" ‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£ Port ‡∏£‡∏∞‡∏ö‡∏ö ‡∏î‡∏±‡∏á‡∏ô‡∏±‡πâ‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏∞‡∏ß‡∏±‡∏á‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á Compatibility ‡∏Å‡∏±‡∏ö Frontend ‡πÄ‡∏î‡∏¥‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ API ‡∏ô‡∏µ‡πâ ‡∏´‡πâ‡∏≤‡∏°‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô Response Structure ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô (‡πÄ‡∏ä‡πà‡∏ô field `mui_colour`)
